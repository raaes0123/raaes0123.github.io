<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../style.css" />
    <link rel="stylesheet" href="../media.css" />
    <link rel="icon" type="image/svg+xml" href="../favicon.svg">
    <title>Bit-banging SPI</title>
</head>

<body>
    <div id="rajesh">Rajesh Shah</div>
    <div class="header">
        <div>
            <a href="../index.html">Blogs</a>
        </div>
        <div>
            <a href="../aboutme.html">About Me</a>
        </div>
    </div>
    <hr>
    <!--<div id="project_container" style="margin-left: 2%; margin-top: 0.8%; align-items: center; display: flex; flex-direction: column">-->
    <div class="project-container">
        <div id="project-title">
            <p>Bit-banging SPI</p>
        </div>
        <!--<p style="font-family:Georgia, 'Times New Roman', Times, serif ;font-size: large; margin: 1%;">February 7, 2025</p>-->
        <p class="date-container">March 8, 2025</p>
        <!--<div class="project_pic_container" style="width: 53%; display: flex; justify-content: center;">-->
        <!-- <div class="project-pic-container">
            <img src="../assets/mutex.png" alt="MUTEX IMG" />
        </div> -->
        <div class="project-details-container">
            <p class="sub-topic">SPI Protocol</p>
            <p>
                SPI is a synchronous serial communication protocol often used to connect microcontrollers with peripherals like displays, sensors, and memory chips.
                It is much simpler than ISP protocol.
            </p>
            <p>
                Key signals:
            <ol>
                <li>
                    SCK (Serial Clock)
                    <ul>
                        <li>Generated by the master.</li>
                        <li>Defines when data is shifted and sampled.</li>
                    </ul>
                </li>
            </ol>
            <ol>
                <li>
                    MOSI (Master Out Slave In)
                    <ul>
                        <li>Data from master to slave.</li>
                    </ul>
                </li>
            </ol>
            <ol>
                <li>
                    MISO (Master In Slave Out)
                    <ul>
                        <li>Data from slave to master.</li>
                    </ul>
                </li>
            </ol>
            <ol>
                <li>
                    CS (Chip Select, sometimes called SS)
                    <ul>
                        <li>Data from slave to master.Active low.</li>
                        <li>Selects the slave device.</li>
                        <li>Multiple slaves can share MOSI/SCK if they each have their own CS line.</li>
                    </ul>
                </li>
            </ol>
            </p>
            <p class="sub-topic">SPI Modes</p>
            <p>
                SPI has four modes, defined by two settings. The mode to be used is based on the device to be interfaced.
            </p>
            <ol>
                <li>CPOL (Clock Polarity): What level the clock idles at (data transmission halts).</li>
                <ul>
                    <li>CPOL = 0 → Clock idles low (SCK = 0 when inactive).</li>
                    <li>CPOL = 1 → Clock idles high (SCK = 1 when inactive).</li>
                </ul>
                <li>CPHA (Clock Phase) → On which clock edge the data is sampled.</li>
                <ul>
                    <li>CPHA = 0 → Data is sampled on the first (leading) edge.</li>
                    <li>CPHA = 1 → Data is sampled on the second (trailing) edge.</li>
                </ul>
            </ol>
            <p>We are using Mode 0 which means clock=0 is idle state and sampling is done at the first edge ie rising edge.</p>
            <p class="sub-topic">Bit transmission</p>
            <p>
                SPI typically sends MSB first.
                For each clock cycle:
            </p>
            <ul>
                <li>Master sets MOSI according to the bit.</li>
                <li>Master toggles SCK and slave samples MOSI in rising edge.</li>
            </ul>
            
            <pre>
    void spiWrite(uint8_t byte){
        for(uint8_t i = 0 ; i < 8 ; i++){
            clrPin(SCK);                     // 1. Clock low
            (byte & 0x80) ? setPin(MOSI)     // 2. Put MSB on MOSI
                            : clrPin(MOSI);
            byte <<= 1;                      // 3. Shift next bit into MSB
            delay_us(10);                    // Small setup delay
            setPin(SCK);                     // 4. Clock high (data is sampled)
            delay_us(10);                    // Hold delay
        }
    }
            </pre>
            <p>The complete code is at </p><a href="https://github.com/raaes0123/Bit-banging-SPI-for-ST7735S-TFT-LCD"><img src="../git.png" style="width: auto;height:40px"></a>
    <footer>
        <p>Copyright &#169; 2025 Rajesh Shah. All Rights Reserved.</p>
    </footer>
</body>

</html>